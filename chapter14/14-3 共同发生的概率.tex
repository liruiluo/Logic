\section{共同发生的概率：乘法定理的数学基础与应用}

\begin{logicbox}[title=引言]
共同发生的概率是概率论中最重要的概念之一，它涉及多个事件同时发生的可能性计算。本节将深入探讨乘法定理的数学基础、逻辑原理和实际应用，分析事件独立性对概率计算的决定性影响。通过掌握独立事件和非独立事件的不同计算方法，我们将能够解决从简单的机会游戏到复杂的医疗决策、工程可靠性分析等各种现实问题。这种理解对于科学研究、风险评估和理性决策具有重要意义。
\end{logicbox}

\subsection{共同发生概率的数学定义与理论基础}

\begin{theorembox}[title=共同发生的数学定义]
\textbf{共同发生}（joint occurrences）是指某个复合事件的单元事件中的两个或两个以上事件的发生。

\textbf{数学表示}：
对于事件$A_1, A_2, \ldots, A_n$，它们的共同发生记为：
$$P(A_1 \cap A_2 \cap \cdots \cap A_n)$$
或简记为：
$$P(A_1 \text{ 且 } A_2 \text{ 且 } \cdots \text{ 且 } A_n)$$

\textbf{实际问题实例}：
我们希望知道从一副牌中连续抽出3张黑桃的概率，或者在一场赛马中喜爱的两匹马都使我输钱的概率，或者将一枚硬币扔十次得到十次正面向上的概率。

\textbf{基本情况分析}：
假定我们正考察的是只有两个单元事件$a$和$b$的发生。当我们要得到$a$并且$b$两者的概率时，我们便要求它们的共同发生。

\textbf{共同发生的特征}：
\begin{itemize}
\item \textbf{交集性质}：共同发生对应集合论中的交集运算
\item \textbf{概率单调性}：$P(A \cap B) \leq \min(P(A), P(B))$
\item \textbf{逻辑合取}：对应逻辑学中的合取（AND）运算
\item \textbf{条件依赖}：计算方法取决于事件间的独立性关系
\end{itemize}
\end{theorembox}

\subsection{独立与非独立事件}

一个困难立即出现了：两个事件中的一个出现或不出现对另外一个事件的出现或不出现产生影响吗？如果存在这样的影响，单元事件就不独立；如果不存在这样的影响，它们就是独立的。如果两个事件中的一个的发生或不发生对另外一个事件的发生或不发生，不产生任何影响，我们说两个事件是\textbf{独立的}。例如，如果我们掷两枚硬币，无论一枚硬币是正面朝上还是反面朝上，不会影响另外一枚硬币是正面朝上还是反面朝上；它们是独立的事件。

\subsection{独立事件的共同发生}

为了讨论事件共同发生的概率，我们先分析比较容易的情况：独立事件的共同发生。考虑这样一个简单问题：掷两枚硬币，两枚均正面朝上的概率是多少？掷两枚硬币有三个可能结果：或两个正面，或两个反面，或一正一反。但是它们不是等可能的。因为，有两种方式发生一正一反，而只有一种方式得到两个正面。第一枚硬币出现正面，第二枚硬币出现反面；或者第一枚硬币出现反面，第二枚硬币出现正面，它们是不同的情况。因而，当我们掷出两枚硬币时，可能出现 4 个不同的可能事件。将之列表如下：

\begin{center}
\begin{tabular}{|c|c|}
\hline
\textbf{第一枚硬币} & \textbf{第二枚硬币} \\
\hline
正 & 正 \\
正 & 反 \\
反 & 正 \\
反 & 反 \\
\hline
\end{tabular}
\end{center}

没有理由期望其中的任何一个情况比其他情况更可能发生，因而我们认为它们是等可能的。两枚正面朝上的特别情形只是 4 个等可能的事件之一，因此，掷出两枚硬币，得到两次正面的概率是 $1 / 4$ 。这个复合事件的概率可以通过两个独立的单元事件的概率而求得。该复合事件由第一次掷出正面和第二次掷出正面，这两个事件的共同发生所构成。第一次掷出正面的概率为 $1 / 2$ ，第二次掷出正面的概率也为 $1 / 2$ 。这两个事件是独立的，因而我们可以用概率计算的\textbf{乘法定理}来计算它们共同发生的概率。根据独立事件的乘法定理，两个独立事件共同发生的概率等于它们各自概率的乘积。这个一般公式可以写成：

$$
P(a \text { 且 } b)=P(a) \times P(b)
$$

这里，$a$、$b$ 为两个独立事件，$P(a)$ 和 $P(b)$ 为它们的概率，而 $P(a$ 且 $b)$为 $a$、$b$ 共同发生的概率。本例中，$a$ 为第一次出现正面的事件，$b$ 为第二次得到正面的事件，这样，$P(a)=1 / 2, P(b)=1 / 2$ ；因此，$P(a$ 且 $b)=$ $1 / 2 \times 1 / 2=1 / 4$ 。

\subsection{骰子问题的概率}

考虑第二个问题。我们摇两个骰子，得到 12 点的概率为多少？只有当每个骰子都为 6 点，两个骰子才出现 12 点。每个骰子有 6 面，摇后每一面向上与其他面向上的可能性相同。假定 $a$ 为第一个骰子出现 6 点的事件，$P(a)=1 / 6$ ；假定 $b$ 为第二个骰子出现 6 点的事件，$P(b)=1 / 6$ 。 $a$ 和 $b$ 的共同发生构成了两个骰子出现 12 点的复合事件。根据乘法定理， $\mathrm{P}(\mathrm{a}$ 且 b$)=1 / 6 \times 1 / 6=1 / 36$ 。 $1 / 36$ 即为要两个骰子得到 12 点的概率。我们也可以通过列举摇两个骰子时所有可能发生的事件，而求得同样的结果。有 36 个等可能事件，列表如下。在表中，每一对数字中的第一个数字代表第一个骰子向上的数字，第二个数字代表第二个骰子向上的数字。

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
1－1 & 2－1 & 3－1 & 4－1 & 5－1 & 6－1 \\
\hline
1－2 & 2－2 & 3－2 & 4－2 & 5－2 & 6－2 \\
\hline
1－3 & 2－3 & 3－3 & 4－3 & 5－3 & 6－3 \\
\hline
1－4 & 2－4 & 3－4 & 4－4 & 5－4 & 6－4 \\
\hline
1－5 & 2－5 & 3－5 & 4－5 & 5－5 & 6－5 \\
\hline
1－6 & 2－6 & 3－6 & 4－6 & 5－6 & 6－6 \\
\hline
\end{tabular}
\end{center}

在 36 个等可能的情况中，只有 1 个为我们希望的（出现 12 点），因而，我们直接得到概率为 $1 / 36$ 。

\subsection{乘法定理的推广}

我们可以将乘法定理一般化，以便涵盖任意多个独立事件的共同发生。如果我们从一副牌中抽出一张牌，将之放回并抽第二次牌，再放回去并抽第三次牌，那么抽出三次黑桃的事件，为第一次抽出黑桃的事件、第二次抽出黑桃的事件和第三次抽出黑桃的事件共同发生所构成。这三个事件用 $a$、$b$、$c$ 来表示，它们共同发生的概率 $P(a$ 且 $b$ 且 $c)$ 等于三个事件各自概率的乘积：$P(a) \times P(b) \times P(c)$ 。这个概率容易计算出来。一副扑克有 52 张牌，其中 13 张为黑桃。因此，抽出一张黑桃的概率为 $13 / 52=1 / 4$ 。由于再次抽牌之前原先抽出的牌被放了回去，第二次抽牌的情况与第一次的一样，因而，$P(a)$、$P(b)$、$P(c)$ 均为 $1 / 4$ 。它们共同发生的概率为 $P(a$ 且 $b$ 且 $c)=1 / 4 \times 1 / 4 \times 1 / 4=1 / 64$ 。我们可以用通用乘法定理计算任意多个独立事件共同发生的概率。

\subsection{非独立事件的共同发生}

现在我们转向分析不独立的事件。将独立事件的概率简单相乘，如上面的例子中所做的，没有考虑单元事件之间的关系。如果那些事件是有关联的，我们需要将这种关系考虑进来，以便精确计算这样的事件的共同发生。我们经常能够这样做。将上述例子做些修改。假定我要求从一副洗好的扑克牌中连续抽三张黑桃的概率，但抽出的牌不放回去。如果每一次抽出的牌在下次抽牌之前不放回去，前面的抽牌结果确实对后面的抽牌结果产生影响。如果抽出的第一张牌是一张黑桃，那么第二次抽牌过程中总的牌数为 51 张牌，剩下的黑桃有 12 张。而如果第一次抽出的不是一张黑桃，那么，剩下的 51 张牌中有 13 张黑桃。假定 $a$ 是从一副牌中抽出一张黑桃并且不放回去的事件，$b$ 为从剩下的牌中抽取另外一张黑桃的事件，那么 $b$ 的概率，即 $P(b \mid a)$为 $12 / 51$ ，即 $4 / 17$ 。如果 $a$ 和 $b$ 都发生，第三次抽牌是在只有 11 张黑桃的 50 张牌中进行。如果 $c$ 是最后的事件，那么 $P(c \mid a$ 且 $b)$为 $11 / 50$ 。于是，从一副牌中抽取三张牌、抽完不放回去，根据乘法定理，三张均是黑桃的概率为 $13 / 52 \times 12 / 51 \times 11 / 50$ ，即 $11 / 850$ 。这个值小于抽三张牌、但每次抽牌后放回去的概率。这也是我们能够预知的，原因是将抽出的牌放回去增加下次抽到黑桃的概率。

\subsection{条件概率与通用乘法定理}

我们来看另外与不独立事件共同发生的概率有关的一个例子。假定有一个袋子，袋子里面有 2 个白球和 1 个黑球。如果我们连续摸两个球，并且第一次摸到的球在第二次摸球之前不放回去，两次摸到的均是白球的概率是多少？假定 $a$ 为第一次摸到白球的事件。有三个等可能性，每个可能性对应于其中一个球。由于两个球为白色的，其中两个可能性能得到白球。因而，第一次摸到白球的概率为 $2 / 3$ 。如果 $a$ 事件发生了，袋中只剩下了两个球，一白一黑。明显的，第二次摸到白球（我们用 $b$ 表示）的概率为 $1 / 2$ ，即 $p(b \mid a)=1 / 2$ 。据通用的乘法定理，摸到两次白球的概率为 $a$ 和 $a$ 条件下 $b$ 共同发生的概率，其值为它们各自发生的概率值的乘积， $2 / 3 \times 1 / 2=1 / 3$ 。通用公式为：

$$
P(a \text { 且 } b)=P(a) \times P(b \mid a)
$$

在这个简单的情况下，我们可以通过计算各个可能的情形而确定连续两次摸到两个白球的概率。我们用 $W_{1}$ 表示一个白球，$W_{2}$ 表示另外一个白球，$B$ 表示黑球，下表列举了所有可能的等可能情况：

\begin{center}
\begin{tabular}{|c|c|}
\hline
\textbf{第一次摸球} & \textbf{第二次摸球} \\
\hline
$W_{1}$ & $W_{2}$ \\
$W_{1}$ & $B$ \\
$W_{2}$ & $W_{1}$ \\
$W_{2}$ & $B$ \\
$B$ & $W_{1}$ \\
$B$ & $W_{2}$ \\
\hline
\end{tabular}
\end{center}

在这 6 个等可能的事件中，两种情形是我们需要的（第一和第三）。连续两次摸球、第一次摸到的球不放回去的概率，我们可以直接求得为 $1 / 3$ 。

\subsection{现实应用：医疗决策中的概率}

通用乘法定理可以用于对现实世界问题的后果估计，下面就是一个例子。一个加利福尼亚少女受慢性白血病的折磨。如果不治疗，它将因白血病而死去。只有找到匹配的骨髓捐赠者，她才能得救。当她的父母寻找这样的捐赠人的所有努力均失败之后，他们决定再生一个小孩，以希望能够成功进行骨髓移植。但她的父亲首先得将切断的输精管接通，这只有 $50\%$ 的成功率。如果成功了，她的母亲因当时有 45 岁，她怀孕的机会也只有 $0.73$ 。如果她确实受孕成功，婴儿骨髓与受病痛折磨的女儿匹配的机会也只有四分之一（ $0.25$ ）。并且即使匹配成功，白血病病人经过必需的化疗和骨髓移植后活下来的机会为 $0.70$ 。

可以看到的是，结果成功的概率很低，但不是低到毫无希望。输精管成功得到接通，母亲也确实怀孕了，至此，希望增加了。巧的是，婴儿拥有能够匹配的骨髓。1992年进行了艰巨的骨髓移植手术。手术获得巨大成功\cite{ayala1993}。这个美满结果其概率在她的父母做决策的时候有多大呢？

\section*{乘法定理}
为了计算两个或更多事件共同发生的概率：

\begin{center}
\begin{tabular}{|p{0.95\textwidth}|}
\hline
\textbf{A．如果这些事件（如 $a$\zhtext{、}$b$ ）是独立的：} \\
它们共同发生的概率为其概率的简单乘积：
$P(a \text { 且 } b)=P(a) \times P(b)$ \\
\hline
\textbf{B．如果这些事件（如 $a$\zhtext{、}$b$\zhtext{、}$c$ 等）是不独立的：} \\
它们共同发生的概率为第一个事件的概率乘以第一个事件发生的条件下第二个事件的概率，乘以第一和第二个事件发生的条件下第三个事件的概率，等等。 \\
$P(a \text{ 且 } b \text{ 且 } c)=P(a) \times P(b \mid a) \times P(c \mid a \text{ 且 } b)$ \\
\hline
\end{tabular}
\end{center}

\begin{center}
\fbox{\parbox{0.95\textwidth}{
\textbf{本节要点}
\begin{itemize}
\item \textbf{共同发生概率的数学定义与理论基础}：
  \begin{itemize}
  \item \textbf{数学表示}：$P(A_1 \cap A_2 \cap \cdots \cap A_n)$，对应集合论的交集运算
  \item \textbf{逻辑性质}：对应逻辑学中的合取（AND）运算，体现多条件同时满足
  \item \textbf{概率特征}：$P(A \cap B) \leq \min(P(A), P(B))$，共同发生概率不超过单个事件概率
  \item \textbf{条件依赖性}：计算方法完全取决于事件间的独立性关系
  \end{itemize}
\item \textbf{独立事件的共同发生与乘法定理}：
  \begin{itemize}
  \item \textbf{独立性定义}：一个事件的发生不影响其他事件的概率
  \item \textbf{简单乘法定理}：$P(a \text{ 且 } b) = P(a) \times P(b)$
  \item \textbf{经典实例}：硬币投掷、骰子摇动等相互无关的随机实验
  \item \textbf{定理推广}：可扩展到任意多个独立事件的共同发生
  \end{itemize}
\item \textbf{非独立事件的共同发生与条件概率}：
  \begin{itemize}
  \item \textbf{非独立性特征}：一个事件的发生改变其他事件的概率分布
  \item \textbf{通用乘法定理}：$P(a \text{ 且 } b) = P(a) \times P(b|a)$
  \item \textbf{条件概率}：$P(b|a)$表示在事件$a$发生条件下事件$b$的概率
  \item \textbf{实际应用}：抽牌不放回、连续选取、医疗决策等复杂情境
  \end{itemize}
\item \textbf{乘法定理的数学结构与应用}：
  \begin{itemize}
  \item \textbf{独立事件公式}：$P(a \text{ 且 } b) = P(a) \times P(b)$
  \item \textbf{非独立事件公式}：$P(a \text{ 且 } b \text{ 且 } c) = P(a) \times P(b|a) \times P(c|a \text{ 且 } b)$
  \item \textbf{现实应用价值}：医疗决策、工程可靠性、风险评估等领域
  \item \textbf{计算验证}：可通过列举所有等可能情况进行验证
  \end{itemize}
\item \textbf{共同发生概率的认识论意义}：
  \begin{itemize}
  \item 为复杂系统的可靠性分析提供数学工具
  \item 体现了概率论在处理多重不确定性中的重要作用
  \item 连接了数学理论与现实决策，具有重要的实践指导价值
  \item 是科学推理和风险评估的重要理论基础
  \end{itemize}
\end{itemize}
}}
\end{center}

% The rest of the file, including exercises, is removed.